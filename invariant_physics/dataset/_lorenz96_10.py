
from .ode import *
from ._utils import params_random, params_default

PARAMS_CONFIG = {
    "task": "Lorenz96_10",
    "env_max": 10,
    "ode_dim": 10,
    "ode_dim_function": 10,
    "params_strategy_list": ["default", "random"],
    "params": {
        "default": params_default,
        "random": params_random,
    },
    "random_params_base": [8.0],
    "default_params_list": [
        [8.0],
        [9.0],
        [10.0],
        [11.0],
        [12.0],
        [13.0],
        [14.0],
        [15.0],
        [16.0],
        [17.0],
    ],
    "random_y0_base": [8.01, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00],
    "default_y0_list": [
        [8.01, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00],
        [9.01, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00],
        [10.01, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00],
        [11.01, 11.00, 11.00, 11.00, 11.00, 11.00, 11.00, 11.00, 11.00, 11.00],
        [12.01, 12.00, 12.00, 12.00, 12.00, 12.00, 12.00, 12.00, 12.00, 12.00],
        [13.01, 13.00, 13.00, 13.00, 13.00, 13.00, 13.00, 13.00, 13.00, 13.00],
        [14.01, 14.00, 14.00, 14.00, 14.00, 14.00, 14.00, 14.00, 14.00, 14.00],
        [15.01, 15.00, 15.00, 15.00, 15.00, 15.00, 15.00, 15.00, 15.00, 15.00],
        [16.01, 16.00, 16.00, 16.00, 16.00, 16.00, 16.00, 16.00, 16.00, 16.00],
        [17.01, 17.00, 17.00, 17.00, 17.00, 17.00, 17.00, 17.00, 17.00, 17.00],
    ],
    "dt": 0.001,
    "t_min": 0,
    "t_max": 10,
    "curve_names": ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j"],
    "rule_map": ['A->(A+A)', 'A->(A-A)', 'A->(A*A)', 'A->(A/A)', 'A->(A*C)', 
                'A->C', 'A->a', 'A->b', 'A->c', 'A->d', 'A->e', 'A->f', 'A->g', 'A->h', 'A->i', 'A->j'],
    "ntn_list": ['A'],
    "truth_ode_format": [
        "1.0*b*j-1.0*i*j-1.0*a+{0}",
        "1.0*c*a-1.0*j*a-1.0*b+{0}",
        "1.0*d*b-1.0*a*b-1.0*c+{0}",
        "1.0*e*c-1.0*b*c-1.0*d+{0}",
        "1.0*f*d-1.0*c*d-1.0*e+{0}",
        "1.0*g*e-1.0*d*e-1.0*f+{0}",
        "1.0*h*f-1.0*e*f-1.0*g+{0}",
        "1.0*i*g-1.0*f*g-1.0*h+{0}",
        "1.0*j*h-1.0*g*h-1.0*i+{0}",
        "1.0*a*i-1.0*h*i-1.0*j+{0}",
    ],
    "purification_threshold": 0.10,
}


class Lorenz96_10(ODEDataset):
    params_config = PARAMS_CONFIG

    def __init__(self, args):
        super(Lorenz96_10, self).__init__(args, PARAMS_CONFIG)

    def _func(self, x, t, env_id):
        F = self.params[env_id][0]
        dy = np.asarray([
            (x[1] - x[8]) * x[9] - x[0] + F,
            (x[2] - x[9]) * x[0] - x[1] + F,
            (x[3] - x[0]) * x[1] - x[2] + F,
            (x[4] - x[1]) * x[2] - x[3] + F,
            (x[5] - x[2]) * x[3] - x[4] + F,
            (x[6] - x[3]) * x[4] - x[5] + F,
            (x[7] - x[4]) * x[5] - x[6] + F,
            (x[8] - x[5]) * x[6] - x[7] + F,
            (x[9] - x[6]) * x[7] - x[8] + F,
            (x[0] - x[7]) * x[8] - x[9] + F,
        ])
        return dy


if __name__ == "__main__":
    pass
